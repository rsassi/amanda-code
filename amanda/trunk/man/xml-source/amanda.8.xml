<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE refentry PUBLIC "-//OASIS//DTD DocBook XML V4.1.2//EN"
                   "http://www.oasis-open.org/docbook/xml/4.1.2/docbookx.dtd"
[
  <!-- entities files to use -->
  <!ENTITY % global_entities SYSTEM '../entities/global.entities'>
  %global_entities;
]>

<!-- lifted from troff+man by doclifter -->
<refentry id='amanda.8'>

<refmeta>
<refentrytitle>amanda</refentrytitle>
<manvolnum>8</manvolnum>
</refmeta>
<refnamediv>
<refname>amanda</refname>
<refpurpose>The Open Source Backup Platform</refpurpose>
</refnamediv>
<!-- body begins here -->

<refsect1><title>DESCRIPTION</title>
<para>This manual page gives an overview of the &A; commands and
configuration files for quick reference.</para>

<refsect2><title>COMMANDS</title> <!-- a.k.a. any section 8 manpage -->
<para>Here are all the &A; commands.  Each one has its own manual page.  See them for all the gory details.</para>
<itemizedlist>
  <listitem><citerefentry><refentrytitle>amaddclient</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amadmin</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amaespipe</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amcheck</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amcheckdb</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amcheckdump</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amcleanup</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amcrypt-ossl-asym</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amcrypt-ossl</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amcrypt</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amcryptsimple</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amdd</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amdevcheck</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amdump</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amfetchdump</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amflush</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amgetconf</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amgpgcrypt</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amlabel</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>ammt</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amoverview</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amplot</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amrecover</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amreport</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amrestore</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amrmtape</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amserverconfig</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amservice</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amstatus</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amtape</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amtapetype</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amtoc</refentrytitle><manvolnum>8</manvolnum></citerefentry></listitem>
</itemizedlist>
</refsect2>
<refsect2><title>CONFIGURATION FILES</title> <!-- a.k.a. any section 5 manpage -->
<itemizedlist>
  <listitem><citerefentry><refentrytitle>amanda.conf</refentrytitle><manvolnum>5</manvolnum></citerefentry></listitem>
  <listitem><citerefentry><refentrytitle>amanda-client.conf</refentrytitle><manvolnum>5</manvolnum></citerefentry></listitem>
</itemizedlist>
</refsect2>
<refsect2><title>CONCEPTS</title> <!-- a.k.a. any section 7 manpage -->
<itemizedlist>
  <listitem><citerefentry><refentrytitle>amanda-devices</refentrytitle><manvolnum>7</manvolnum></citerefentry></listitem>
</itemizedlist>
</refsect2>
</refsect1>

<refsect1><title>CONFIGURATION</title>
<para>There are three user-editable files that control the behavior of &A;.
</para>
<para>
The first is
<emphasis remap='B'>amanda.conf</emphasis>,
the main configuration file.
It contains parameters to customize &A; for the site.
Refer to the 
<citerefentry><refentrytitle>amanda.conf</refentrytitle><manvolnum>5</manvolnum></citerefentry>,
manpage for details on &A; configuration parameters.
</para>
<para>
Second is the
<emphasis remap='I'>disklist</emphasis>
file, which lists hosts and disk partitions to back up.
</para>
<para>
Third is the
<emphasis remap='I'>tapelist</emphasis>
file, which lists tapes that are currently active.
These files are described in more detail in the following sections.</para>

<para>All files are stored in individual configuration
directories, usually under <filename>/etc/amanda/</filename>.
A site will often have more than
one configuration.
For example, it might have a
<emphasis remap='I'>normal</emphasis>
configuration for everyday backups and an
<emphasis remap='I'>archive</emphasis>
configuration for infrequent full archival backups.
The configuration files would be stored under directories
<filename>/etc/amanda/normal/</filename> and
<filename>/etc/amanda/archive/</filename>, respectively.
Part of the job of an &A; administrator is to create,
populate and maintain these directories.</para>

<para>All log and database files generated by &A; go in corresponding
directories somewhere.
The exact location is controlled by entries in
<emphasis remap='B'>amanda.conf</emphasis>.
A typical location would be under <filename>/var/adm/amanda</filename>.
For the above example, the files might go in
<filename>/var/adm/amanda/normal/</filename> and
<filename>/var/adm/amanda/archive/</filename>.
</para>

<para>As log files are no longer needed (no longer contain relevant information),
&A; cycles them out in various ways, depending on the type of file.</para>

<para>Detailed information about
<command>amdump</command>
runs are stored in dump logs -- files named
<emphasis remap='B'>amdump.</emphasis><emphasis remap='I'>NN</emphasis>
where
<emphasis remap='I'>NN</emphasis>
is a sequence number, with 1 being the most recent file.
<emphasis remap='B'>Amdump</emphasis>
rotates these files each run, keeping roughly the last
<emphasis remap='B'>tapecycle</emphasis>
(see below)
worth of them.</para>

<para>The file used by
<emphasis remap='B'>amreport</emphasis>
to generate the mail summary is the trace log.  This file constitutes the "catalog"
describing the data on the tapes written in a run.  It is named
<emphasis remap='B'>log.</emphasis><emphasis remap='I'>YYYYMMDDHHMMSS.NN</emphasis>
where
<emphasis remap='I'>YYYYMMDDHHMMSS</emphasis>
is the datestamp of the start of the
<command>amdump</command> or <command>amflush</command>
run and
<emphasis remap='I'>NN</emphasis>
is a sequence number started at 0.
At the end of each
<command>amdump</command>
run,
log files for runs whose tapes have been reused are renamed
into a subdirectory of the main log directory (see the
<emphasis remap='B'>logdir</emphasis>
parameter below)
named
<emphasis remap='B'>oldlog</emphasis>.
It is up to the &A; administrator to remove them from this
directory when desired.</para>

<para>Index (backup image catalogue) files older than the full dump
matching the oldest backup image for a given client and disk
are removed by
<command>amdump</command>
at the end of each run.</para>
</refsect1>

<refsect1><title>DISKLIST FILE</title>
<para>The
<emphasis remap='I'>disklist</emphasis>
file determines which disks will be backed up by &A;.
The file usually contains one line per disk:</para>

<programlisting>
<emphasis>hostname diskname</emphasis> [<emphasis>diskdevice</emphasis>] <emphasis>dumptype</emphasis> [<emphasis>spindle</emphasis> [<emphasis>interface</emphasis>] ]
</programlisting>

<para>All pairs [ <emphasis>hostname diskname</emphasis> ] must be unique.</para>

<para>Lines starting with # are ignored, as are blank lines.
The fields have the following meanings:</para>
<variablelist remap='TP'>
  <varlistentry>
  <term><emphasis remap='I'>hostname</emphasis></term>
  <listitem>
<para>The name of the host to be backed up.
If
<emphasis remap='B'>diskdevice</emphasis>
refers to a PC share, this is the host &A; will run the Samba
<emphasis remap='B'>smbclient</emphasis> program on to back up the share.</para>
  </listitem>
  </varlistentry>
  <varlistentry>
  <term><emphasis remap='I'>diskname</emphasis></term>
  <listitem>
<para>The name of the disk (a label).
In most case, you set your
<emphasis remap='B'>diskname</emphasis>
to the
<emphasis remap='B'>diskdevice</emphasis>
and you don't set the
<emphasis remap='B'>diskdevice.</emphasis>
If you want multiple entries with the same
<emphasis remap='B'>diskdevice</emphasis>,
you must set a different
<emphasis remap='B'>diskname</emphasis>
for each entry. It's the
<emphasis remap='B'>diskname</emphasis>
that you use on the commandline for any &A; command.
Look at the example/disklist file for example.</para>
  </listitem>
  </varlistentry>
  <varlistentry>
  <term><emphasis remap='I'>diskdevice</emphasis></term>
  <listitem>
<para>Default: same as diskname.
The name of the disk device to be backed up. It may be a full device name,
a device name without the
<filename>/dev/</filename>
prefix, e.g.
<emphasis remap='I'>sd0a</emphasis>,
or a mount point such as
<filename>/usr</filename>.</para>

<para>It may also refer to a PC share by starting the name with two (forward) slashes, e.g.
<filename>//some-pc/home</filename>.
In this case, the
<emphasis remap='B'>program</emphasis>
option in the associated
<emphasis remap='B'>dumptype</emphasis>
must be entered as
<emphasis remap='B'>GNUTAR</emphasis>.
It is the combination of the double slash disk name and
<emphasis remap='B'>program GNUTAR</emphasis>
in the
<emphasis remap='B'>dumptype</emphasis>
that triggers the use of Samba.</para>
</listitem>
</varlistentry>
  
  <varlistentry>
  <term><emphasis remap='I'>dumptype</emphasis></term>
  <listitem>
<para>Refers to a
<emphasis remap='B'>dumptype</emphasis>
defined in the
<emphasis remap='B'>amanda.conf</emphasis>
file.
<emphasis remap='I'>Dumptype</emphasis>s
specify backup related parameters,
such as whether to compress the backups,
whether to record backup results in
<filename>/etc/dumpdates</filename>, the disk's relative priority, etc.</para>
  </listitem>
  </varlistentry>
  <varlistentry>
  <term><emphasis remap='I'>spindle</emphasis></term>
  <listitem>
<para>Default:
<option>-1</option>.
A number used to balance backup load on a host.
&A; will not run multiple backups at the same time
on the same spindle, unless the spindle number is -1,
which means there is no spindle restriction.</para>
  </listitem>
  </varlistentry>
  <varlistentry>
  <term><emphasis remap='I'>interface</emphasis></term>
  <listitem>
<para>Default:
<emphasis remap='I'>local</emphasis>.
The name of a network interface definition in the
<emphasis remap='B'>amanda.conf</emphasis>
file, used to balance network load.</para>
  </listitem>
  </varlistentry>
</variablelist>

<para>Instead of naming a
<emphasis remap='B'>dumptype</emphasis>,
it is possible to define one in-line, enclosing
<emphasis remap='B'>dumptype</emphasis>
options within curly braces, one per line, just like a
<emphasis remap='B'>dumptype</emphasis>
definition in
<emphasis remap='B'>amanda.conf</emphasis>.
Since pre-existing
<emphasis remap='B'>dumptype</emphasis>s
are valid option names, this syntax may be used to customize
<emphasis remap='B'>dumptype</emphasis>s
for particular disks.</para>

<para>A line break
<emphasis remap='B'>must</emphasis>
follow the left curly bracket.</para>

<para>For instance, if a
<emphasis remap='B'>dumptype</emphasis>
named
<emphasis remap='I'>normal</emphasis>
is used for most disks, but use of the holding disk needs to be disabled
for the file system that holds it, this would work instead of defining
a new dumptype:</para>

<programlisting>
<emphasis remap='I'>hostname diskname</emphasis> [ <emphasis remap='I'>diskdevice</emphasis> ] {
  normal
  holdingdisk never
} [ <emphasis remap='I'>spindle</emphasis> [ <emphasis remap='I'>interface</emphasis> ] ]
</programlisting>

</refsect1>

<refsect1><title>TAPE MANAGEMENT</title>
<para>The
<emphasis remap='I'>tapelist</emphasis>
file contains the list of tapes in active use.
This file is maintained entirely by &A; and should not be created
or edited during normal operation.
It contains lines of the form:</para>

<para><programlisting>YYYYMMDD label flags
</programlisting></para>

<para>Where
<emphasis remap='I'>YYYYMMDD</emphasis>
is the date the tape was written,
<emphasis remap='I'>label</emphasis>
is a label for the tape as written by
<emphasis remap='B'>amlabel</emphasis>
and
<emphasis remap='I'>flags</emphasis>
tell &A; whether the tape may be reused, etc (see the
<emphasis remap='B'>reuse</emphasis>
options of
<emphasis remap='B'>amadmin</emphasis>).</para>

<para><emphasis remap='B'>Amdump</emphasis>
and
<emphasis remap='B'>amflush</emphasis>
will refuse to write to an unlabeled tape, or to a labeled tape that is considered active.
There must be more tapes in active rotation (see the
<emphasis remap='B'>tapecycle</emphasis>
option) than there are runs in the backup cycle (see the
<emphasis remap='B'>dumpcycle</emphasis>
option) to prevent overwriting a backup image that would be needed to do a full recovery.</para>
</refsect1>

<refsect1 id='output_drivers'><title>OUTPUT DRIVERS</title>
<para>The normal value for the
<emphasis remap='B'>tapedev</emphasis>
parameter, or for what a tape changer returns,
is a full path name to a non-rewinding tape device, such as
<filename>/dev/nst0</filename>
or
<filename>/dev/rmt/0mn</filename>
or
<filename>/dev/nst0.1</filename>
or whatever conventions the operating system uses. &A; provides additional application level drivers that
support non-traditional tape-simulations or features. To access a specific output driver, set
<emphasis remap='B'>tapedev</emphasis>
(or configure your changer to return) a string of the form
<emphasis remap='I'>driver</emphasis>:<emphasis remap='I'>driver-info</emphasis>
where
<emphasis remap='I'>driver</emphasis>
is one of the supported drivers and
<emphasis remap='I'>driver-info</emphasis>
is optional additional information needed by the driver.</para>

<para>The supported drivers are:</para>
<variablelist remap='TP'>
  <varlistentry>
  <term><emphasis remap='I'>tape</emphasis></term>
  <listitem>
<para>This is the default driver.
The
<emphasis remap='I'>driver-info</emphasis>
is the tape device name.
Entering
<programlisting>tapedev /dev/rmt/0mn
</programlisting>
is really a short hand for
<programlisting>tapedev tape:/dev/rmt/0mn
</programlisting></para>
  </listitem>
  </varlistentry>
  <varlistentry>
  <term><emphasis remap='I'>null</emphasis></term>
  <listitem>
<para>This driver throws away anything written to it and returns EOF
for any reads except a special case is made for reading a label,
in which case a &quot;fake&quot; value is returned that &A; checks for
and allows through regardless of what you have set in
<emphasis remap='B'>labelstr</emphasis>.
The
<emphasis remap='I'>driver-info</emphasis>
field is not used and may be left blank:</para>

<para><programlisting>tapedev null:
</programlisting></para>

<para>The <emphasis remap='I'>length</emphasis>
value from the associated
<emphasis remap='B'>tapetype</emphasis>
is used to limit the amount of data written. When the limit is reached, the driver will simulate end of tape.</para>

<note><para>This driver should only be used for debugging and testing,
and probably only with the
<emphasis remap='B'>record</emphasis>
option set to
<emphasis remap='I'>no</emphasis>.
</para>
</note>
  </listitem>
  </varlistentry>

  <varlistentry>
  <term><emphasis remap='I'>rait</emphasis></term>
  <listitem>
<para><emphasis remap='I'>R</emphasis>edundant
<emphasis remap='I'>A</emphasis>rray
of
<emphasis remap='I'>I</emphasis>nexpensive (?)
<emphasis remap='I'>T</emphasis>apes.
Reads and writes tapes mounted on multiple drives by spreading
the data across N-1 drives and using the last drive for a checksum.
See docs/RAIT for more information.</para>

<para>The
<emphasis remap='I'>driver-info</emphasis>
field describes the devices to use. Curly braces indicate multiple replacements in the string.
For instance:</para>

<para><programlisting>tapedev rait:/dev/rmt/tps0d{4,5,6}n
</programlisting></para>

<para>would use the following devices:</para>

<para><filename>/dev/rmt/tps0d4n</filename>
<filename>/dev/rmt/tps0d5n</filename>
<filename>/dev/rmt/tps0d6n</filename>
</para>
  </listitem>
  </varlistentry>
</variablelist>
<variablelist remap='TP'>
  <varlistentry>
  <term><emphasis remap='I'>file</emphasis></term>
  <listitem>
<para>This driver emulates a tape device with a set of files in a directory.
The
<emphasis remap='I'>driver-info</emphasis>
field must be the name of an existing directory.
The driver will test for a subdirectory of that named
<emphasis remap='I'>data</emphasis>
and return
<emphasis remap='B'>offline</emphasis>
until it is present.
When present, the driver uses two files in the
<emphasis remap='I'>data</emphasis>
subdirectory for each tape file. One contains the actual data.
The other contains record length information.</para>

<para>The driver uses a file named
<emphasis remap='I'>status</emphasis>
in the
<emphasis remap='B'>file</emphasis>
device directory to hold driver status information, such as tape position.
If not present, the driver will create it as though the device is rewound.</para>

<para>The
<emphasis remap='I'>length</emphasis>
value from the associated
<emphasis remap='B'>tapetype</emphasis>
is used to limit the amount of data written.
When the limit is reached, the driver will simulate end of tape.</para>

<para>One way to use this driver with a real device such as a CD-writer is to
create a directory for the
<emphasis remap='B'>file</emphasis>
device and one or more other directories for the actual data.
Create a symlink named
<emphasis remap='I'>data</emphasis>
in the
<emphasis remap='B'>file</emphasis>
directory to one of the data directories.
Set the
<emphasis remap='B'>tapetype</emphasis>
length to whatever the medium will hold.</para>

<para>When &A; fills the
<emphasis remap='B'>file</emphasis>
device, remove the symlink and (optionally) create a new symlink to another
data area.
Use a CD writer software package to burn the image from the first data area.</para>

<para>To read the CD, mount it and create the
<emphasis remap='I'>data</emphasis>
symlink in the
<emphasis remap='B'>file</emphasis>
device directory.</para>
</listitem>
</varlistentry>
</variablelist>
</refsect1>

<refsect1><title>AUTHORIZATION</title>
<para>&A; processes on the tape server host run as the
<emphasis remap='B'>dumpuser</emphasis>
user listed in
<emphasis remap='B'>amanda.conf</emphasis>.
When they connect to a backup client, they do so with an &A;-specific protocol.
They do not, for instance, use
<emphasis remap='B'>rsh</emphasis>
or
<emphasis remap='B'>ssh</emphasis>
directly.</para>

<para>On the client side, the
<emphasis remap='B'>amandad</emphasis>
daemon validates the connection using one of several methods,
depending on how it was compiled and on options it is passed:</para>

<variablelist remap='IP'>
  <varlistentry>
  <term>.rhosts</term>
  <listitem>
<para>Even though &A; does not use
<emphasis remap='B'>rsh</emphasis>,
it can use
<markup>.rhosts</markup>-style
authentication and a
<markup>.rhosts</markup>
file.</para>
  </listitem>
  </varlistentry>
  <varlistentry>
  <term>.amandahosts</term>
  <listitem>
<para>This is essentially the same as
<markup>.rhosts</markup>
authentication except a different file, with almost the same format, is used.
This is the default mechanism built into &A;.</para>

<para>The format of the
<filename>.amandahosts</filename>
file is:</para>

<para><emphasis remap='I'>hostname</emphasis>
[
<emphasis remap='I'>username</emphasis>
[
<emphasis remap='I'>service</emphasis>
]*]</para>

<para>If
<emphasis remap='I'>username</emphasis>
is ommitted, it defaults to the user running
<emphasis remap='B'>amandad</emphasis>,
i.e. the user listed in the
<emphasis remap='B'>inetd</emphasis>
or
<emphasis remap='B'>xinetd</emphasis>
configuration file.</para>
<para>The <emphasis remap='I'>service</emphasis> is a list of the service the client is authorized to execute:
<emphasis remap='B'>amdump</emphasis>,
<emphasis remap='B'>noop</emphasis>,
<emphasis remap='B'>selfcheck</emphasis>,
<emphasis remap='B'>sendsize</emphasis>,
<emphasis remap='B'>sendbackup</emphasis>,
<emphasis remap='B'>amindexd</emphasis>,
<emphasis remap='B'>amidxtaped</emphasis>.
<emphasis remap='B'>amdump</emphasis> is a shortcut for "noop selfcheck sendsize sendbackup"</para>
  </listitem>
  </varlistentry>
  <varlistentry>
  <term>Kerberos</term>
  <listitem>
<para>&A; may use the Kerberos authentication system.
Further information is in the
<emphasis remap='B'>docs/KERBEROS</emphasis>
<!-- TODO: edit link -->
file that comes with an &A; distribution.</para>

<para>For Samba access,
&A; needs a file on the Samba server (which may
or may not also be the tape server) named
<filename>/etc/amandapass</filename>
with share names, (clear text) passwords and (optional) domain names,
in that order, one per line, whitespace separated.
By default, the user used to connect to the PC is the same for all
PC's and is compiled into &A;.
It may be changed on a host by host basis
by listing it first in the password field followed
by a percent sign and then the password.
For instance:</para>
<programlisting>
  //some-pc/home normalpw
  //another-pc/disk otheruser%otherpw
</programlisting>
<para>With clear text passwords, this file should obviously be tightly protected.
It only needs to be readable by the &A;-user on the Samba server.  </para>
<para>You can find further information in the
<emphasis remap='B'>docs/SAMBA</emphasis>
<!-- TODO: edit link -->
file that comes with an &A; distribution.</para>

</listitem>
</varlistentry>
</variablelist>
</refsect1>

<refsect1><title>HOST &amp; DISK EXPRESSION</title>
<para>All host and disk arguments to programs are special expressions.
The command applies to all disks that match your arguments.
This section describes the matcher.</para>

<para>The matcher matches by word, each word is a glob expression, words
are separated by the separator '.' for host and '/' for disk. You
can anchor the expression at left with a '^'. You can
anchor the expression at right with a '$'. The matcher
is case insensitive for host but is case sensitive for disk. A match
succeeds if all words in your expression match contiguous words in 
the host or disk.</para>


<informaltable frame="none">
<tgroup cols="2" align="left">
<tbody>

<row>
<entry>.  </entry>
<entry>word separator for a host</entry>
</row>

<row>
<entry>/</entry>
<entry>word separator for a disk</entry>
</row>

<row>
<entry>^</entry>
<entry>anchor at left</entry>
</row>

<row>
<entry>$</entry>
<entry>anchor at right</entry>
</row>

<row>
<entry>?</entry>
<entry>match exactly one character except the separator</entry>
</row>

<row>
<entry>*</entry>
<entry>match zero or more characters except the separator</entry>
</row>

<row>
<entry>**</entry>
<entry>match zero or more characters including the separator</entry>
</row>

</tbody>
</tgroup>
</informaltable>

<para>Some examples:</para>

<informaltable frame="none">
<tgroup cols="3" align="left">
<tbody>

<row>
<entry>EXPRESSION  </entry>
<entry>WILL MATCH</entry>
<entry>WILL NOT MATCH</entry>
</row>

<row>
<entry>hosta</entry>
<entry>hosta</entry>
<entry>hostb</entry>
</row>

<row>
<entry></entry>
<entry>hoSTA.dOMAIna.ORG</entry>
<entry></entry>
</row>

<row>
<entry></entry>
<entry>foo.hosta.org</entry>
<entry></entry>
</row>

<row>
<entry>host</entry>
<entry>host</entry>
<entry>hosta</entry>
</row>

<row>
<entry>host?</entry>
<entry>hosta</entry>
<entry>host</entry>
</row>

<row>
<entry></entry>
<entry>hostb</entry>
<entry></entry>
</row>

<row>
<entry>ho*na</entry>
<entry>hoina</entry>
<entry>ho.aina.org</entry>
</row>

<row>
<entry>ho**na</entry>
<entry>hoina</entry>
<entry></entry>
</row>

<row>
<entry></entry>
<entry>ho.aina.org</entry>
<entry></entry>
</row>

<row>
<entry>^hosta</entry>
<entry>hosta</entry>
<entry>foo.hosta.org</entry>
</row>

<row>
<entry>sda*</entry>
<entry>/dev/sda1</entry>
<entry></entry>
</row>

<row>
<entry></entry>
<entry>/dev/sda12</entry>
<entry></entry>
</row>

<row>
<entry>/opt</entry>
<entry>opt (disk)</entry>
<entry>opt (host)</entry>
</row>

<row>
<entry>.opt.</entry>
<entry>opt (host)</entry>
<entry>opt (disk)</entry>
</row>

<row>
<entry>/</entry>
<entry>/</entry>
<entry>any other disk</entry>
</row>

<row>
<entry>/usr</entry>
<entry>/usr</entry>
<entry></entry>
</row>

<row>
<entry></entry>
<entry>/usr/opt</entry>
<entry></entry>
</row>

<row>
<entry>/usr$</entry>
<entry>/usr</entry>
<entry>/usr/opt</entry>
</row>

</tbody>
</tgroup>
</informaltable>


</refsect1>

<refsect1><title>DATESTAMP EXPRESSION</title>
<para>A
<emphasis remap='I'>datestamp</emphasis>
expression is a range expression where we only match the prefix.
Leading ^ is removed. Trailing $ forces an exact match.</para>

<informaltable frame="all">
<tgroup cols="2" align="left">
<tbody>

<row>
<entry>20001212-14</entry>
<entry>match all dates beginning with 20001212, 20001213 or 20001214</entry>
</row>

<row>
<entry>20001212-4</entry>
<entry>same as previous</entry>
</row>

<row>
<entry>20001212-24</entry>
<entry>match all dates between 20001212 and 20001224</entry>
</row>

<row>
<entry>2000121</entry>
<entry>match all dates that start with 2000121 (20001210-20001219)</entry>
</row>

<row>
<entry>2</entry>
<entry>match all dates that start with 2 (20000101-29991231)</entry>
</row>

<row>
<entry>2000-10</entry>
<entry>match all dates between 20000101-20101231</entry>
</row>

<row>
<entry>200010$</entry>
<entry>match only 200010</entry>
</row>

</tbody>
</tgroup>
</informaltable>
<para/>

</refsect1>

<refsect1><title>DUMP SPECIFICATIONS</title> <para>A dump
specification selects one or more dumps.  It has the form <emphasis
remap="I">[host][:disk][@datestamp]</emphasis>, where each component
is a pattern as described above.  If a component is missing, it
is treated as a wildcard.  The characters ':', '@', and '\' may be
escaped within any component by preceding them with a '\'.</para>

<para>Some examples:</para>

<informaltable frame="none">
<tgroup cols="2" align="left">
<tbody>

<row>
<entry>DUMPSPEC</entry>
<entry>DESCRIPTION</entry>
</row>

<row>
<entry>client17</entry>
<entry>all dumps of client17</entry>
</row>

<row>
<entry>@20080615</entry>
<entry>All dumps on with datestamps matching 20080615</entry>
</row>

<row>
<entry>webserver:/var/www</entry>
<entry>All dumps of /var/www on host webserver</entry>
</row>

<row>
<entry>webserver:/var/www@200806150317</entry>
<entry>The dump of webserver with datestamp 200806150317</entry>
</row>

<row>
<entry>:/var/www</entry>
<entry>All dumps of /var/www on any host</entry>
</row>

</tbody>
</tgroup>
</informaltable>


</refsect1>

<refsect1><title>CONFIGURATION OVERRIDE</title>
<para>Most commands allow the override of specific
configuration options on the command line, using the <arg
choice="plain">-o</arg> option.  This option has the form <arg
choice="plain">-o</arg><replaceable>name</replaceable>=<replaceable>value</replaceable>.
An optional space is allowed after the <arg choice="plain">-o</arg>.
Each configuration option should be specified in a separate
command-line option.</para>

<para>For global options, <replaceable>name</replaceable> is simply the name of the option, e.g.,
<programlisting>
amdump -oruntapes=2
</programlisting>
For options in a named section of the configuration, <replaceable>name</replaceable> has the
form <replaceable>SECTION</replaceable>:<replaceable>section_name</replaceable>:<replaceable>name</replaceable>,
where <replaceable>SECTION</replaceable> is one of TAPETYPE, DUMPTYPE, HOLDINGDISK, or INTERFACE, and
<replaceable>section_name</replaceable> is the name of the tapetype, dumptype, holdingdisk, or interface.
Examples:
<programlisting>
amdump -o TAPETYPE:HP-DAT:length=2000m
amdump -o DUMPTYPE:no-compress:compress="server fast"
amdump -o HOLDINGDISK:hd1:use="-100 mb"
amdump -o INTERFACE:local:use="2000 kbps"
</programlisting>
</para>

<para>When overriding device properties, one must carefully quote the
  command line to simulate the syntax of real configuration files. The
  following example should serve as a guide:
<programlisting>
amdump -o 'device-property="PROPERTY_MAX_VOLUME_USAGE" "100000"'
</programlisting></para>

<para>Note that configuration overrides are not effective for tape
changers, which supply a tapedev based on their own configuration.  In order to
override <emphasis remap="I">tapedev</emphasis>, you must also disable any changer:
<programlisting>
amdump -otapedev=/dev/nst1 -otpchanger=''
</programlisting>
</para>

</refsect1>

<refsect1><title>AUTHOR</title>
<para>James da Silva, &email.jds; : Original text</para>
<para>&maintainer.sgw;: XML-conversion, major update</para>
</refsect1>

</refentry>

